# @eva/promo

# Микросервис для создания промо-материалов для website

## Файл `local.env`:

==== Адреса всех микросервисов ====
`PROMO_URL=http://localhost:5001`

==== promo ====
`PROMO_ENABLED=false`
`PROMO_PORT=5001`

По умолчанию локально сервис выключен, чтобы его запустить, задайте значение `PROMO_ENABLED=true` и перезапустите проект.

## Структура микросервиса

1. `src`
   ...
2. `store`
   - Файл `main.json` в папке `lists` служит для управления последовательностью промо-материалов для каждой страны.
   - В папке `promotions` находятся все промо-материалы для каждой страны.

### Структура файла `main.json`

```json
{
  "country1": [ // название страны*
    "promo1", // название акции как в папке promotions
    "promo2",
    "promo3",
    ...
  ],
  ...
}
```

- страны - `RUS`, `KAZ`, `BLR`, `UZB`.

#### По умолчанию

По умолчанию, если промо-материалы не указаны в массиве, они будут сортироваться в алфавитном порядке, как они располагаются в папке promotions. Если вы не добавили строку для конкретной страны или промо-материала, они будут отображаться в конце списка в алфавитном порядке.

#### Изменение последовательности промо-материалов

Для изменения порядка вам необходимо добавить в массив строки промо-материалов в нужной последовательности.

```json
{
  "country1": [
    "promo3",
    "promo2"
    // promo1 неявно встанет в конец списка
  ]
}
```

#### Важно

- Указывайте только существующие промо-материалы из папки `promotions`. Проверьте, что строки, указанные в массиве для каждой страны, соответствуют названиям промо-материалов в папке `promotions`.

### Структура папки с промо-материалами (в promotions)

```plaintext
[promo]
└── [country]
    └── info.json
    └── main
        ├── info.json
        ├── desktop-image.jpg
        ├── mobile-image.jpg
        ├── desktop-video.mp4 [?]
        ├── mobile-video.mp4 [?]
        ├── desktop-image-timer.jpg [?]
        ├── mobile-image-timer.jpg [?]
        ├── desktop-video-timer.mp4 [?]
        └── mobile-video-timer.mp4 [?]
```

- `[?]` - необязательные файлы
- `promo` - название акции
- `country` - страна, где должны размещаться промо-материалы `(rus / blr / kaz / uzb)`

### Создание промо-материалов

1. Создайте папку `[promo]` с названием акции, например, `skandivaniya`
2. В ней создайте папки `[country]` с кодом страны, например, `rus`
3. В папке страны создайте файл `info.json`, параметры, которые в нем могут быть:

```json
{
  "startDate": "string", // [?] дата старта акции в формате UTC*
  "endDate": "string", // [?] дата окончания акции в формате UTC*
  "regions": "string"[], // [?] включить в регионах*
  "excludedRegions": "string"[], // [?] выключить в регионах*
  "enabled": boolean, // [?] акция активна
  "disabled": boolean, // [?] акция неактивна
}
```

- `[?]` - необязательные поля.
- `*UTC` - например `"2023-07-18T07:00:00.000Z"`
- `*регион` - наименование региона как в url.

4. В той же папке создайте папку `main`, где будет находится вся информация для промо-материалов.
5. Добавьте ресурсы (изображения и/или видео, с таймером и/или без) с такими же названиями как в структуре выше.
6. Создайте файл `info.json`, параметры, которые в нем могут быть:

```json
"template": "default" | "atr", // шаблон
"alignmentX": "center" | "left", // выравнивание по оси x
"alignmentY": "center" | "top", // выравнивание по оси y
"inversed": boolean, // инвертировать цвет текста на белый
"needSound": boolean, // [?] добавить иконку звука для видео
"link": "string", // [?] ссылка куда ведет баннер
"timerStartDate": "string", // [?] дата начала таймера
"modes": "string"[], // [?] модификаторы стилей, см ниже варианты

"localization": { // текст
  "ru": {
    "period": "string", // [?] период
    "title": "string", // заголовок
    "subtitle": "string", // подзаголовок
    "subtitleMobile": "string", // [?] подзаголовок на моб. устр.
    "link": "string", // текст ссылки
    "condition": "string", // [?] примечание
    "conditionMobile": "string", // [?] примечание на моб. устр.
  };
  "uz": { // [?]
    ...
  };
};
```

- `[?]` - необязательные поля
- `modes` - массив применяемых модификаторов:

| mode                   | описание                                                  |
| ---------------------- | --------------------------------------------------------- |
| `onlyDesktopTimer`     | Показать таймер только на настольных устройствах          |
| `onlyMobileTimer`      | Показать таймер только на мобильных устройствах           |
| `whiteMobileCondition` | Сделать примечание на мобильных устройствах белого цвета  |
| `blackMobileCondition` | Сделать примечание на мобильных устройствах черного цвета |
| `condition400px`       | Добавить к примечанию `max-width: 400px`                  |

